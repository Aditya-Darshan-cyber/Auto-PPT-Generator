# Short Write-Up

## How input text is parsed and mapped to slides
The app supports two parsing paths: an LLM planner (via AI Pipe → OpenAI-compatible API) and a deterministic fallback parser. In both paths, raw text/markdown is first normalized (whitespace, control characters) and scrubbed for obvious secrets (URLs, emails, API keys). The LLM is prompted to return strict JSON with a deck title plus slide objects (title, bullets, optional speaker notes, and a layout hint). It’s archetype-aware: guidance like “investor pitch” or “SOP” steers section ordering (e.g., Problem→Solution→Market or Purpose→Prerequisites→Procedure). Bullets are concise and deduplicated; equations are preserved inline; code blocks are summarized instead of copied.

If an LLM key isn’t provided or a call fails, the heuristic parser kicks in. It’s markdown-aware (headings, ordered/unordered lists, fenced code) and flattens nested lists into readable bullets. When headings are missing, it chunks text by sentences and, if the guidance implies an archetype, buckets content into those sections. Legal/medical inputs add an informational disclaimer (or notes). Slide counts are chosen from content size and capped to avoid clutter.

## How the app applies the template’s visual style and assets
The PPTX builder loads the user’s template and transfers theme elements automatically. It parses `ppt/theme/theme*.xml` to capture major/minor fonts and the color scheme (dk1/lt1, accent1–accent6) and applies these to all titles and bullet runs. Layout selection honors the outline’s hint (“Title and Content”, “Two Content”, “Content with Caption”, etc.) while checking actual placeholder capabilities; “Two Content” spreads bullets across two text frames when available. Existing images in the template (`ppt/media/*`) are reused politely—only in layouts with picture placeholders—without generating new images. Speaker notes are added when requested. The output is a `.pptx` that looks native to the uploaded template, with safe file checks to prevent zip-bombs or corrupt archives.
